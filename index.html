<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exam Study Tracker - Home</title>
  <!-- Link to your neon-themed CSS -->
  <link rel="stylesheet" href="styles.css">
  <!-- Optional: Bootstrap CSS for layout -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <!-- Shooting Stars -->
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>

  <div class="container">
    <!-- User Profile Header -->
    <div class="user-profile d-flex justify-content-end align-items-center my-3">
      <img src="" alt="Profile Image" id="profileImage" class="rounded-circle" style="width:50px; height:50px; margin-right:10px;">
      <span id="usernameDisplay" class="font-weight-bold"></span>
    </div>

    <!-- Countdown Timer -->
    <div class="countdown" id="countdown"></div>

    <!-- Overall Progress Section -->
    <div class="card my-4">
      <div class="card-body">
        <h4 class="card-title">Overall Progress</h4>
        <div class="progress">
          <div class="progress-bar" id="overallProgressBar" role="progressbar" 
               style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            0%
          </div>
        </div>
      </div>
    </div>

    <!-- Button to navigate to the subjects page -->
    <div class="text-center">
      <a href="study.html" class="btn btn-lg btn-primary">Study Time</a>
    </div>
  </div>

  <script>
    // --- Load User Data ---
    const user = JSON.parse(localStorage.getItem('user'));
    if(user && user.name) {
      document.getElementById('usernameDisplay').textContent = user.name;
      document.getElementById('profileImage').src = user.profileImage || "10337609.png";
    } else {
      // If no user is logged in, redirect to the login page.
      window.location.href = "login.html";
    }

    // --- Shared Variables & Functions ---
    const subjects = ["Physics", "Maths", "Biology", "Chemistry"];
    const grades = ["9", "10", "11", "12"];
    const unitsPerGrade = 8;

    // Initialize studyProgress in localStorage if not already set.
    function initStudyProgress() {
      if (!localStorage.getItem('studyProgress')) {
        let progress = {};
        subjects.forEach(subject => {
          progress[subject] = {};
          grades.forEach(grade => {
            progress[subject][grade] = new Array(unitsPerGrade).fill(false);
          });
        });
        localStorage.setItem('studyProgress', JSON.stringify(progress));
      }
    }

    function getStudyProgress() {
      return JSON.parse(localStorage.getItem('studyProgress'));
    }

    // Calculate overall progress across all subjects/grades.
    function calculateOverallProgress() {
      const progress = getStudyProgress();
      let total = 0, completed = 0;
      subjects.forEach(subject => {
        grades.forEach(grade => {
          progress[subject][grade].forEach(unitDone => {
            total++;
            if(unitDone) completed++;
          });
        });
      });
      return (completed / total) * 100;
    }

    // Update the overall progress bar.
    function updateOverallProgress() {
      const overallProgress = calculateOverallProgress();
      const overallProgressBar = document.getElementById('overallProgressBar');
      overallProgressBar.style.width = overallProgress.toFixed(1) + "%";
      overallProgressBar.innerHTML = overallProgress.toFixed(1) + "%";
    }

    // --- Countdown Timer Functions ---
    function getExamDate() {
      const now = new Date();
      let examYear = now.getFullYear();
      // JavaScript months are 0-indexed: 6 means July.
      const examDateThisYear = new Date(examYear, 6, 1);
      if (now > examDateThisYear) {
        examYear++;
      }
      return new Date(examYear, 6, 1);
    }
    
    function updateCountdown() {
      const now = new Date();
      const examDate = getExamDate();
      const diff = examDate - now;
      if (diff <= 0) {
        document.getElementById('countdown').innerHTML = "Exam Day!";
        clearInterval(countdownInterval);
        return;
      }
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);
      document.getElementById('countdown').innerHTML = 
        "Time until exam: " + days + "d " + hours + "h " + minutes + "m " + seconds + "s";
    }
    
    // --- Initialize & Start ---
    initStudyProgress();
    updateOverallProgress();
    updateCountdown();
    const countdownInterval = setInterval(updateCountdown, 1000);
  </script>


  <style>
    /* Reset & Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* Body: Neon Purple-Blue Gradient Background */
body {
  font-family: 'Arial', sans-serif;
  background: linear-gradient(135deg, #1e0f3f, #2d1463, #4b2a69);
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
}

/* Shooting Stars */
/* (For best effect, add several elements like below in your HTML body:)
     <div class="shooting-star"></div>
     <div class="shooting-star"></div>
     <div class="shooting-star"></div>
     ...  */
.shooting-star {
  position: absolute;
  width: 2px;
  height: 80px;
  background: linear-gradient(-45deg, transparent, rgba(255,255,255,0.8), transparent);
  opacity: 0;
  animation: shooting-star 5s linear infinite;
}

/* Different positions & delays for variety */
.shooting-star:nth-child(1) {
  top: 10%;
  left: 80%;
  animation-delay: 0s;
}
.shooting-star:nth-child(2) {
  top: 20%;
  left: 60%;
  animation-delay: 2s;
}
.shooting-star:nth-child(3) {
  top: 30%;
  left: 90%;
  animation-delay: 4s;
}
.shooting-star:nth-child(4) {
  top: 40%;
  left: 50%;
  animation-delay: 1s;
}
.shooting-star:nth-child(5) {
  top: 50%;
  left: 70%;
  animation-delay: 3s;
}

@keyframes shooting-star {
  0% {
    opacity: 0;
    transform: translate(0, 0) rotate(45deg);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translate(-100vw, 100vh) rotate(45deg);
  }
}

/* Container: Ensures content stays on top of the animated background */
.container {
  padding: 20px;
  position: relative;
  z-index: 1;
}

/* Card Styling: Modern, Semi-transparent Neon Cards */
.card {
  background: rgba(0, 0, 0, 0.5);
  border: none;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(10px);
  transition: transform 0.3s ease-in-out;
}

.card:hover {
  transform: scale(1.02);
}

.card-body {
  padding: 20px;
}

/* Subject Title: Neon Glow */
.subject-title {
  font-size: 1.5em;
  font-weight: bold;
  color: #ff00ff; /* Neon Pink */
  text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
}

/* Progress Bars: Modern Neon Gradient */
.progress {
  background-color: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  overflow: hidden;
  height: 20px;
  margin-bottom: 20px;
}

.progress-bar {
  background: linear-gradient(45deg, #00f5ff, #ff00ff);
  box-shadow: 0 0 10px #ff00ff;
  font-weight: bold;
}

/* Countdown Timer: Bold Neon Cyan */
.countdown {
  text-align: center;
  margin-bottom: 30px;
  font-size: 2em;
  font-weight: bold;
  color: #00ffff; /* Neon Cyan */
  text-shadow: 0 0 5px rgba(0, 255, 255, 0.8);
}

/* Grade Section: Stylish Divisions for Each Grade */
.grade-section {
  margin-top: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.3);
  border-left: 3px solid #ff00ff;
  border-radius: 5px;
}

.grade-section h5 {
  margin-bottom: 10px;
  color: #ffcc00;
  text-shadow: 0 0 3px rgba(255, 204, 0, 0.8);
}

/* Checkboxes & Labels */
.unit-checkbox {
  margin-right: 5px;
  margin-bottom: 5px;
  accent-color: #00f5ff; /* For modern browsers */
}

.grade-section label {
  margin-right: 15px;
  cursor: pointer;
}

</style>
</body>
</html>
